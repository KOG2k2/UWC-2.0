<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<title>UWC 2.0 | Nhiệm vụ</title>
	<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
	<link rel="icon" href="../../assets/img/icon.ico" type="image/x-icon"/>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<!-- Fonts and icons -->
	<script src="../../assets/js/plugin/webfont/webfont.min.js"></script>
	<script>
		WebFont.load({
			google: {"families":["Lato:300,400,700,900"]},
			custom: {"families":["Flaticon", "Font Awesome 5 Solid", "Font Awesome 5 Regular", "Font Awesome 5 Brands", "simple-line-icons"], urls: ['../../assets/css/fonts.min.css']},
			active: function() {
				sessionStorage.fonts = true;
			}
		});
	</script>

	<link rel="stylesheet" href="../../assets/css/bootstrap.min.css">
	<link rel="stylesheet" href="../../assets/css/atlantis.min.css">
	<link href="../assets/styles.css" rel="stylesheet" />
	<link href="../assets/prism.css" rel="stylesheet" />
</head>
<body>
	<div class="wrapper">
		<div class="main-header">	
			<div class="logo-header" data-background-color="light-blue2">
				<a href="../index.html" class="logo" style="color: #ffffff;">
					<img class= "resize" src="../../assets/img/truck.png" width = "50" height = "40">
				</a>
				<button class="navbar-toggler sidenav-toggler ml-auto" type="button" data-toggle="collapse" data-target="collapse" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon">
						<i class="icon-menu"></i>
					</span>
				</button>
				<button class="topbar-toggler more"><i class="icon-options-vertical"></i></button>
				<div class="nav-toggle">
					<button class="btn btn-toggle toggle-sidebar">
						<i class="icon-menu"></i>
					</button>
				</div>
			</div>
			<nav class="navbar navbar-header navbar-expand-lg" data-background-color="light-blue2">
				<div class="container-fluid">
					<ul class="navbar-nav topbar-nav ml-md-auto align-items-center">
						<li class="nav-item" style="display: flex; align-items:center;">
							<p style="font-size: 24px; margin: 0px 8px 0px 0px;">&#128269;</p>
							<p style="font-size: 24px; margin: 0px 8px 0px 0px;">&#128276;</p>
							<div style="width: 32px; height: 32px; background-image: url(https://vcdn1-ngoisao.vnecdn.net/2013/09/27/lau-dai1-6322-1380268105.jpg?w=0&h=0&q=100&dpr=2&fit=crop&s=scYhVY94akP9jwv6TIl8cw);
							background-position: center;
							background-repeat: no-repeat;
							background-size: cover;
							border-radius: 50%;"></div>

							<p style="color: #ffffff; font-weight: bold; margin: 0px 8px 0px 8px;">Lâu Đài</p>
							<a href="../log.html">
								<img class= "resize" src="../../assets/img/logout.png" width = "40" height = "30">
							</a>
						</li>
					</ul>
				</div>
			</nav>
		</div>
		<div class="sidebar sidebar-style-2">
			<div class="sidebar-background"></div>
			<div class="sidebar-wrapper scrollbar scrollbar-inner">
				<div class="sidebar-content">
					<ul class="nav nav-info">
						<li class="nav-item">
							<a href="../index.html">
								<i class="fas fa-home"></i>
								<p>Trang chủ</p>
							</a>
						</li>
						<li class="nav-section">
							<span class="sidebar-mini-icon">
								<i class="fa fa-ellipsis-h"></i>
							</span>
							<h4 class="text-section">Mô đun</h4>
						</li>				
						<li class="nav-item active">
							<a href="./alerts.html">
								<p>Nhiệm vụ</p>
							</a>
						</li>
						<li class="nav-item">
							<a href="avatars.html">
								<p>Nhân viên</p>
							</a>
						</li>
						<li class="nav-item">
							<a href="#">
								<p>Tin nhắn</p>
							</a>
						</li>
						<li class="nav-item">
							<a href="#">
								<p>Quản lý</p>
							</a>
						</li>

						<li class="nav-section">
							<span class="sidebar-mini-icon">
								<i class="fa fa-ellipsis-h"></i>
							</span>
							<h4 class="text-section">Tùy chọn</h4>
						</li>
						<li class="nav-item">
							<a href="#">
								<p>Hồ sơ</p>
							</a>
						</li>
						<li class="nav-item">
							<a href="#">
								<p>Cài đặt</p>
							</a>
						</li>
					</ul>
				</div>
			</div>
		</div>
		<div class="main-panel">
			<div class="content content-documentation" align="center">
				<form class="m-3 w-50" align="left">
					<div class="form-group">
						<label for="InputUsername1"><i class = "fa fa-user"></i> Nhân viên</label>
						<div class="form-group">
						  <select class="form-control" name="" id="Staff">
							<option selected disabled id="defaultStaff">Chọn công nhân</option>
							<option>Lao công 1</option>
							<option>Lao công 2</option>
							<option>Lao công 3</option>
							<option>Lao công 4</option>
							<option>Lao công 5</option>
						  </select>
						</div>
					</div>

					<div class="form-group">
						<label for="InputUsername1"><i class = "fa fa-truck"></i> Phương tiện</label>
						<div class="form-group">
						  <select class="form-control" name="" id="Vehicle">
							<option selected disabled id="defaultVehicle">Chọn phương tiện</option>
							<option>Xe 1</option>
							<option>Xe 2</option>
							<option>Xe 3</option>
						  </select>
						</div>
					</div>

					<div class="form-group">
						<label for="InputUsername1"><i class = "fa fa-home"></i> Địa điểm</label>
						<div class="form-group">
						  <select class="form-control" name="" id="Site">
							<option selected disabled id="defaultSite">Chọn địa điểm thu gom</option>
							<option>Địa điểm 1</option>
							<option>Địa điểm 2</option>
							<option>Địa điểm 3</option>
							<option>Địa điểm 4</option>
						  </select>
						</div>
					</div>

					<div class="form-group">
						<button class="btn btn-primary" type="button" id="CreateTask">Tạo nhiệm vụ</button>
					</div>
				</form>

				<table class="table table-striped table-hover m-3" id="TaskTable" style="width:85%">
					<thead class = "thead-dark">
					  <tr>
						<th scope="col" style="width:5%">STT</th>
						<th scope="col" style="width:35%">Công nhân</th>
						<th scope="col" style="width:30%">Phương tiện</th>
						<th scope="col" style="width:30%">Địa điểm thu gom</th>
					  </tr>
					</thead>
					<tbody>
					</tbody>
				</table>

				<div id="myModal" class="modal fade bd-example-modal-sm" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">
  					<div class="modal-dialog modal-sm">
    					<div class="modal-content">
							<div class="modal-body">
							<h6 style="font-size:1.5em" id="alert">Success!</h6>
							</div>
							<div class="row justify-content-center m-3">
								<button type="button" class="btn btn-primary" id="closeModal">OK</button>
							</div>
    					</div>
  					</div>
				</div>

			</div>
		</div>
	</div>
</div>
</body>
<script src="../../assets/js/core/jquery.3.2.1.min.js"></script>
<script src="../../assets/js/plugin/jquery-ui-1.12.1.custom/jquery-ui.min.js"></script>
<script src="../../assets/js/plugin/jquery-ui-touch-punch/jquery.ui.touch-punch.min.js"></script>
<script src="../../assets/js/core/popper.min.js"></script>
<script src="../../assets/js/core/bootstrap.min.js"></script>
<script src="../../assets/js/plugin/chart.js/chart.min.js"></script>
<script src="../../assets/js/plugin/bootstrap-notify/bootstrap-notify.min.js"></script>
<script src="../../assets/js/plugin/bootstrap-toggle/bootstrap-toggle.min.js"></script>
<script type="text/javascript" src="../../assets/js/plugin/jqvmap/jquery.vmap.min.js"></script>
<script type="text/javascript" src="../../assets/js/plugin/jqvmap/maps/jquery.vmap.world.js" charset="utf-8"></script>
<script src="../../assets/js/plugin/chart-circle/circles.min.js"></script>
<script src="../../assets/js/plugin/jquery-scrollbar/jquery.scrollbar.min.js"></script>
<script src="../../assets/js/atlantis.min.js"></script>
<script src="../assets/prism.js"></script>
<script src="../assets/prism-normalize-whitespace.min.js"></script>
<script type="text/javascript">
	// Optional
	Prism.plugins.NormalizeWhitespace.setDefaults({
		'remove-trailing': true,
		'remove-indent': true,
		'left-trim': true,
		'right-trim': true,
	});

	// handle links with @href started with '#' only
	$(document).on('click', 'a[href^="#"]', function(e) {
		// target element id
		var id = $(this).attr('href');

		// target element
		var $id = $(id);
		if ($id.length === 0) {
			return;
		}

		// prevent standard hash navigation (avoid blinking in IE)
		e.preventDefault();

		// top position relative to the document
		var pos = $id.offset().top - 80;

		// animated top scrolling
		$('body, html').animate({scrollTop: pos});
	});

	function counter() {
    if ( typeof counter.value == 'undefined' ) {
        counter.value = 0;
    }
    counter.value++;
	return counter.value;
	}

	function addRow(data, index){
		var tableRef = document.getElementById("TaskTable").getElementsByTagName("tbody")[0];
		var newRow = tableRef.insertRow(tableRef.rows.length);

		var newText = document.createTextNode(counter());
		newRow.insertCell().appendChild(newText);
		var newText = document.createTextNode(Object.values(data[index])[0]);
		newRow.insertCell().appendChild(newText);
		var newText = document.createTextNode(Object.values(data[index])[1]);
		newRow.insertCell().appendChild(newText);
		var newText = document.createTextNode(Object.values(data[index])[2]);
		newRow.insertCell().appendChild(newText);
	}

	var task_data = new Array();
	task_data = JSON.parse(localStorage.getItem("task_data"));
	
	if(task_data != null){
		for(i = 0; i < task_data.length; i++){
			addRow(task_data, i);
		}
	}

	document.getElementById("CreateTask").addEventListener("click", (event)=>{
		var Worker = document.getElementById("Staff").value;
		var Vehicle = document.getElementById("Vehicle").value;
		var CollectionPoint = document.getElementById("Site").value;

		if(Worker == document.getElementById("defaultStaff").innerHTML){
			document.getElementById("alert").innerHTML = "Chưa lựa chọn công nhân!";
			$("#myModal").modal();
		} else if (Vehicle == document.getElementById("defaultVehicle").innerHTML){
			document.getElementById("alert").innerHTML = "Chưa lựa chọn phương tiện!";
			$("#myModal").modal();
		} else if (CollectionPoint == document.getElementById("defaultSite").innerHTML){
			document.getElementById("alert").innerHTML = "Chưa lựa chọn địa điểm!";
			$("#myModal").modal();
		} else {
			var new_task = {"Staff":Worker, "Vehicle":Vehicle, "Site":CollectionPoint};
			
			if(task_data == null){
				task_data = new Array(new_task);
			} else {
				task_data.push(new_task);
			}
			localStorage.setItem("task_data", JSON.stringify(task_data));
		
			addRow(task_data, task_data.length - 1);

			document.getElementById("alert").innerHTML = "Thành công!";
			$("#myModal").modal();

			document.getElementById("Staff").value = document.getElementById("defaultStaff").innerHTML;
			document.getElementById("Vehicle").value = document.getElementById("defaultVehicle").innerHTML;
			document.getElementById("Site").value = document.getElementById("defaultSite").innerHTML;
		}
	})

	document.getElementById("closeModal").addEventListener("click", (event)=>{
		$("#myModal").modal("toggle");
	})
</script>
</html>
